/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/Device","sap/base/security/encodeXML","sap/ui/thirdparty/jqueryui/jquery-ui-position"],function(jQuery,e,t){"use strict";var a={};a.render=function(e,t){t.doBeforeRendering();e.write("<div");e.writeControlData(t);e.addClass("sapUiRoadMap");e.writeClasses();e.writeAttribute("tabindex","0");var a=t.getTooltip_AsString();if(a){e.writeAttributeEscaped("title",a)}e.writeAttribute("style","width:"+(t.getWidth()?t.getWidth():"100%")+";");e.write(">");r(e,t,true);e.write("<ul");e.writeAttribute("id",t.getId()+"-steparea");e.addClass("sapUiRoadMapStepArea");e.writeClasses();if(sap.ui.getCore().getConfiguration().getAccessibility()){e.writeAttribute("role","group");e.writeAttributeEscaped("aria-label",c("RDMP_DEFAULT_TOOLTIP",[]));if(a){e.writeAttributeEscaped("title",a)}}e.write(">");var i=t.getSteps();for(var d=0;d<i.length;d++){var n=i[d];if(n.getSubSteps().length>0){u(e,t,n)}else{s(e,t,n)}}e.write("</ul>");r(e,t,false);e.write("</div>")};a.selectStepWithId=function(e,t){var a=e.getSelectedStep();if(a){i(a).removeClass("sapUiRoadMapSelected")}if(t){i(t).addClass("sapUiRoadMapSelected")}if(sap.ui.getCore().getConfiguration().getAccessibility()){if(a){i(a+"-box").removeAttr("aria-checked")}if(t){i(t+"-box").attr("aria-checked",true)}}};a.selectStep=function(e,t,r,s,d,n){if(!n){a.selectStepWithId(e,t.getId())}if(!r&&t.getSubSteps().length>0){var o=t.getSubSteps();var l=t.$();var p=l.hasClass("sapUiRoadMapExpanded");var f=1;var u=function(){f--;if(f>0){return}if(d){d(!p?"expanded":"collapsed")}a.updateStepArea(e)};var g=function(t,a,r){var d=i(t);if(!jQuery.fx.off&&!s){d.width(a?"0px":e.iStepWidth);var n=i(t+"-label");n.addClass("sapUiRoadMapHidden");if(a){d.toggleClass("sapUiRoadMapHidden")}d.animate({width:a?e.iStepWidth:"0px"},"fast",function(){if(!a){d.toggleClass("sapUiRoadMapHidden")}d.width("");n.removeClass("sapUiRoadMapHidden");if(r){r()}})}else{d.toggleClass("sapUiRoadMapHidden");if(r){r()}}};l.toggleClass("sapUiRoadMapExpanded");if(sap.ui.getCore().getConfiguration().getAccessibility()){var v=l.hasClass("sapUiRoadMapExpanded");t.$("box").attr("aria-expanded",v);t.$("expandend-box").attr("aria-expanded",v)}for(var c=0;c<o.length;c++){if(o[c].getVisible()){f++;g(o[c].getId(),!p,u)}}g(t.getId()+"-expandend",!p,u)}else{if(d){d("selected")}}};a.updateStepArea=function(e){if(e.iStepWidth!=-1){var t=e.$("steparea");var a=e.$("Start");var i=e.$("End");var r=e.$();var s=t.scrollLeft();var d=r.width()-a.outerWidth(true)-i.outerWidth(true);var n=e.getNumberOfVisibleSteps();var o=b(e);if(n<1){n=o}else{n=Math.min(n,o)}var l=Math.floor(d/e.iStepWidth);var p=Math.min(n,l);t.width(p*e.iStepWidth).scrollLeft(s);v(e)}};a.updateScrollArea=function(e,t){a.updateStepArea(e);if(!t){var r=e.$("steparea");var s=w(e,false);if(e.getFirstVisibleStep()){var d=i(e.getFirstVisibleStep());if(d.length){s=S(r,d)}}R(e,s+C()*r.scrollLeft(),true)}};a.isVisibleRef=function(e,t){var a=e.$("steparea");var i=a.children(":visible");for(var r=0;r<i.length;r++){var s=jQuery(i.get(r));if(s.attr("id")==t){var d=S(a,s);return d>=0&&d<a.width()}}return false};a.getFirstVisibleRef=function(e){var t=e.$("steparea");var a=t.children(":visible");for(var i=0;i<a.length;i++){var r=jQuery(a.get(i));if(S(t,r)==0){return r}}return null};a.setStepLabel=function(e,a){var i=a?t(a):"";e.$("label").html(i);e.$("expandend-label").html(i);if(!sap.ui.getCore().getConfiguration().getAccessibility()){return}e.$("box").attr("aria-label",l(e,a));e.$("expandend-box").attr("aria-label",l(e,a))};a.setStepEnabled=function(e,t,a){var i=t.$();var r=t.$("expandend");if(a){i.removeClass("sapUiRoadMapDisabled");r.removeClass("sapUiRoadMapDisabled");if(sap.ui.getCore().getConfiguration().getAccessibility()){t.$("box").removeAttr("aria-disabled");t.$("expandend-box").removeAttr("aria-disabled")}return false}else{var s=e.getSelectedStep()==t.getId();if(s){i.removeClass("sapUiRoadMapSelected")}i.addClass("sapUiRoadMapDisabled");r.addClass("sapUiRoadMapDisabled");if(sap.ui.getCore().getConfiguration().getAccessibility()){var d=t.$("box");d.attr("aria-disabled",true);if(s){d.removeAttr("aria-checked")}t.$("expandend-box").attr("aria-disabled",true)}return s}};a.setStepVisible=function(e,t,a,i){var r=t.$();var s=t.$("expandend");var d=e.getSelectedStep()==t.getId();var n=t.getParent();if(a){if(n.getEnabled()&&n.getVisible()&&n.getExpanded()){if(i){r.removeClass("sapUiRoadMapHidden")}else{r.addClass("sapUiRoadMapHidden")}}}else{if(i){r.removeClass("sapUiRoadMapHidden")}else{r.addClass("sapUiRoadMapHidden")}var o=t.getSubSteps();if(o.length>0&&t.getExpanded()){if(i){s.removeClass("sapUiRoadMapHidden")}else{s.addClass("sapUiRoadMapHidden")}for(var l=0;l<o.length;l++){if(o[l].getVisible()){var p=o[l].$();if(e.getSelectedStep()==o[l].getId()){d=true;p.removeClass("sapUiRoadMapSelected");o[l].$("box").removeAttr("aria-checked")}if(i){p.removeClass("sapUiRoadMapHidden")}else{p.addClass("sapUiRoadMapHidden")}}}}}return d};a.setRoadMapWidth=function(e,t){var a=e.$();a.attr("style","width:"+(t?t:"100%")+";")};a.scrollToNextStep=function(e,t,a){var i=t;if(t=="first"||t=="last"){i=w(e,t=="last")}R(e,i,false,a)};a.addEllipses=function(e){if(!e){return}var a=e.$("label");var i=e.getLabel();var r=i+"";var s=jQuery('<label class="sapUiRoadMapTitle" style="display:none;position:absolute;overflow:visible;font-weight:bold;height:auto">'+r+"</label>");s.width(a.width());jQuery(sap.ui.getCore().getStaticAreaRef()).append(s);var n=false;while(r.length>0&&s.height()>a.height()){r=r.substr(0,r.length-1);s.html(t(r+"..."));n=true}if(n){a.html("<span>"+t(r)+"</span>");a.attr("title",e.getLabel())}else{a.attr("title",d(e))}s.remove()};a.updateStepAria=function(e){if(!sap.ui.getCore().getConfiguration().getAccessibility()){return}var t=e.getParent()instanceof sap.ui.commons.RoadMap;var a=e.getParent()[t?"getSteps":"getSubSteps"]();for(var i=0;i<a.length;i++){var r=p(a[i]);var s=f(a[i]);var d=a[i].$("box");d.attr("aria-posinset",r);d.attr("aria-setsize",s);if(t&&a[i].getSubSteps().length>0){d=a[i].$("expandend-box");d.attr("aria-posinset",r);d.attr("aria-setsize",s)}}};var i=function(e){return jQuery(e?document.getElementById(e):null)};var r=function(e,t,a){var i=a?"Start":"End";e.write("<div");e.writeAttribute("id",t.getId()+"-"+i);e.writeAttribute("tabindex","-1");var r=true;e.addClass(r?"sapUiRoadMap"+i+"Scroll":"sapUiRoadMap"+i+"Fixed");e.addClass("sapUiRoadMapDelim");e.addClass("sapUiRoadMapContent");e.writeClasses();e.write("></div>")};var s=function(e,t,a,i,r,s){e.write("<li");if(s){e.writeAttribute("id",s)}else{e.writeElementData(a)}var l=g(t,a);a.__stepName=l;var p=d(a);e.addClass("sapUiRoadMapContent");e.addClass("sapUiRoadMapStep");if(!a.getVisible()){e.addClass("sapUiRoadMapHidden")}if(a.getEnabled()){if(t.getSelectedStep()==a.getId()){e.addClass("sapUiRoadMapSelected")}}else{e.addClass("sapUiRoadMapDisabled")}if(i){for(var f=0;f<i.length;f++){e.addClass(i[f])}}e.writeClasses();e.write(">");n(e,s?s:a.getId(),1);e.write("<div");e.writeAttribute("id",(s?s:a.getId())+"-box");e.writeAttribute("tabindex","-1");e.addClass("sapUiRoadMapStepBox");e.writeClasses();e.writeAttributeEscaped("title",p);o(e,t,a,r?true:false);e.write("><span>");e.write(l);e.write("</span>");if(r){r(e,t,a)}e.write("</div>");e.write("<label");e.writeAttribute("id",(s?s:a.getId())+"-label");e.addClass("sapUiRoadMapTitle");e.writeAttributeEscaped("title",p);e.writeClasses();e.write(">");var u=a.getLabel();if(u){e.writeEscaped(u)}e.write("</label>");n(e,s?s:a.getId(),2);e.write("</li>")};var d=function(e){var t=e.getTooltip_AsString();if(!t&&!e.getTooltip()&&sap.ui.getCore().getConfiguration().getAccessibility()){t=c("RDMP_DEFAULT_STEP_TOOLTIP",[e.__stepName])}return t||""};var n=function(e,t,a){e.write("<div");e.writeAttribute("id",t+"-add"+a);e.addClass("sapUiRoadMapStepAdd"+a);e.writeClasses();e.write("></div>")};var o=function(e,t,a,i){if(!sap.ui.getCore().getConfiguration().getAccessibility()){return}e.writeAttribute("role","treeitem");if(a.getEnabled()){e.writeAttribute("aria-checked",t.getSelectedStep()==a.getId())}else{e.writeAttribute("aria-disabled",true)}e.writeAttribute("aria-haspopup",i);e.writeAttribute("aria-level",a.getParent()instanceof sap.ui.commons.RoadMap?1:2);e.writeAttribute("aria-posinset",p(a));e.writeAttribute("aria-setsize",f(a));e.writeAttributeEscaped("aria-label",l(a,a.getLabel()));if(!i){return}e.writeAttribute("aria-expanded",a.getExpanded())};var l=function(e,t){var a=e.getParent()instanceof sap.ui.commons.RoadMap&&e.getSubSteps().length>0;var i=t||"";if(e.getEnabled()){i=c(a?"RDMP_ARIA_EXPANDABLE_STEP":"RDMP_ARIA_STANDARD_STEP",[i])}return i};var p=function(e){var t=e.getParent()instanceof sap.ui.commons.RoadMap;var a=e.getParent()[t?"indexOfStep":"indexOfSubStep"](e);var i=0;var r=e.getParent()[t?"getSteps":"getSubSteps"]();for(var s=0;s<a;s++){if(!r[s].getVisible()){i++}}return a+1-i};var f=function(e){var t=e.getParent()instanceof sap.ui.commons.RoadMap;var a=e.getParent()[t?"getSteps":"getSubSteps"]();var i=a.length;for(var r=0;r<a.length;r++){if(!a[r].getVisible()){i--}}return i};var u=function(e,t,a){var i=function(e,t,a,i,r){e.write("<div");e.writeAttribute("id",a+"-ico");e.addClass("sapUiRoadMapStepIco");if(r){e.addClass(r)}e.writeClasses();e.write("></div>")};var r=a.getExpanded();s(e,t,a,r?["sapUiRoadMapExpanded"]:null,function(e,t,a){i(e,t,a.getId(),r?"roundtripstart.gif":"roundtrip.gif")});var d=a.getSubSteps();for(var n=0;n<d.length;n++){var o=["sapUiRoadMapSubStep"];if(!r&&d[n].getVisible()){o.push("sapUiRoadMapHidden")}s(e,t,d[n],o)}o=["sapUiRoadMapExpanded","sapUiRoadMapStepEnd"];if(!r){o.push("sapUiRoadMapHidden")}s(e,t,a,o,function(e,t,a){i(e,t,a.getId()+"-expandend","roundtripend.gif")},a.getId()+"-expandend")};var g=function(e,t){var a=t.getParent();if(a===e){return a.indexOfStep(t)+1}var i=a.indexOfSubStep(t);if(i<26){return String.fromCharCode(97+i)}var r=Math.floor(i/26)-1;var s=i%26;return String.fromCharCode(97+r,97+s)};var v=function(e){var t=C();var a=e.$("steparea");var i=h(a);var r=e.$("Start");r.removeClass("sapUiRoadMapStartScroll").removeClass("sapUiRoadMapStartFixed");r.addClass(t*i>=e.iStepWidth?"sapUiRoadMapStartScroll":"sapUiRoadMapStartFixed");var s=e.$("End");s.removeClass("sapUiRoadMapEndScroll").removeClass("sapUiRoadMapEndFixed");var d=a.get(0).scrollWidth-t*i-a.width()<e.iStepWidth;s.addClass(d?"sapUiRoadMapEndFixed":"sapUiRoadMapEndScroll")};var c=function(e,t){var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.commons");if(a){return a.getText(e,t)}return e};var b=function(e){var t=0;var a=e.getSteps();for(var i=0;i<a.length;i++){if(a[i].getVisible()){t++;if(a[i].getExpanded()){t++;var r=a[i].getSubSteps();for(var s=0;s<r.length;s++){if(r[s].getVisible()){t++}}}}}return t};var S=function(e,t){var a=t.position().left;if(sap.ui.getCore().getConfiguration().getRTL()){a=e.width()-a-t.outerWidth()}return a};var C=function(){return sap.ui.getCore().getConfiguration().getRTL()?-1:1};var h=function(t){if(sap.ui.getCore().getConfiguration().getRTL()&&e.browser.webkit){return-1*(t.get(0).scrollWidth-t.scrollLeft()-t.width())}return t.scrollLeft()};var w=function(t,a){var i=t.$("steparea").get(0).scrollWidth;if(sap.ui.getCore().getConfiguration().getRTL()&&e.browser.webkit){return a?0:-1*i}return a?i:0};var R=function(e,t,i,r){var s=e.$("steparea");s.stop(false,true);if(t=="next"){t=s.scrollLeft()+e.iStepWidth*C()}else if(t=="prev"){t=s.scrollLeft()-e.iStepWidth*C()}else if(t=="keep"){t=s.scrollLeft()}else{t=t*C()}var d=function(){v(e);if(r){var t=a.getFirstVisibleRef(e);r(t.attr("id"))}};if(!jQuery.fx.off&&!i){s.animate({scrollLeft:t},"fast",d)}else{s.scrollLeft(t);d()}};return a},true);
//# sourceMappingURL=RoadMapRenderer.js.map