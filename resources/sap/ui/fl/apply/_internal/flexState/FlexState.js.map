{"version":3,"file":"FlexState.js","names":["sap","ui","define","_omit","each","merge","ObjectPath","Log","Component","prepareAppDescriptorMap","prepareChangesMap","prepareCompVariantsMap","prepareVariantsMap","Loader","ManifestUtils","StorageUtils","LayerUtils","Utils","FlexInfoSession","FlexState","_mInstances","_mNavigationHandlers","_mInitPromises","_oShellNavigationService","_oURLParsingService","_oChangePersistenceFactory","_mFlexObjectInfo","appDescriptorChanges","prepareFunction","pathInResponse","changes","variants","compVariants","_mExternalData","enhancePropertyBag","mPropertyBag","oComponent","get","componentId","componentData","getComponentData","manifest","rawManifest","getManifestObject","reference","getFlexReference","getInstanceEntryOrThrowError","sReference","sMapName","Error","preparedMaps","storageResponse","filterByMaxLayer","unfilteredStorageResponse","callPrepareFunction","getAppDescriptorMap","getChangesMap","getVariantsMap","getCompVariantsMap","createSecondInstanceIfNecessary","endsWith","aParts","split","pop","sReferenceWithoutComponent","join","getEmptyFlexDataResponse","partialFlexState","mResponse","mFilteredReturn","mFlexObjects","oURLParsingService","getUShellService","isLayerFilteringRequired","iIndex","mFlexObjectInfo","forEach","sPath","set","filterChangeDefinitionsByMaxLayer","loadFlexData","then","registerMaxLayerHandler","storeAllContextsProvided","oResponse","info","undefined","oFlexInfoSession","getByReference","allContextsProvided","setByReference","oShellNavigationService","handleMaxLayerChange","bind","registerNavigationFilter","deRegisterMaxLayerHandler","unregisterNavigationFilter","sNewHash","sOldHash","sCurrentMaxLayer","getMaxLayerTechnicalParameter","sPreviousMaxLayer","clearFilteredResponse","oError","error","message","NavigationFilterStatus","Continue","checkPartialFlexState","mInitProperties","oFlexInstance","partialFlexData","reInitialize","checkComponentId","sFlexInstanceComponentId","loadUShellServices","Promise","all","aServices","catch","sServiceName","getUshellContainer","lazyLoadModules","requireAsync","aModules","initialize","sFlexReference","mEvaluatedProperties","clearAndInitialize","clearState","normalizeReference","_instanceCache","hasOwnProperty","removeDirtyChanges","Object","keys","setInitialNonFlCompVariantData","sPersistencyKey","oStandardVariant","aVariants","standardVariant","getInitialNonFlCompVariantData","setFakeStandardVariant","sComponentId","oVariantsMap","getVariantsState","resetFakedStandardVariants","getUIChanges","getAppDescriptorChanges","oContent","sVariantManagementReference","oVariants","getUI2Personalization","ui2personalization","getStorageResponse","resolve","getFlexObjectsFromStorageResponse"],"sources":["FlexState-dbg.js"],"mappings":";;;;;AAMAA,IAAIC,GAAGC,OAAO,CACb,iCACA,qBACA,sBACA,2BACA,eACA,wBACA,mFACA,gEACA,0EACA,yEACA,6CACA,oDACA,2CACA,uBACA,kBACA,6CACE,SACFC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA,aA2CA,IAAIC,EAAY,CAAC,EAEjB,IAAIC,EAAc,CAAC,EACnB,IAAIC,EAAuB,CAAC,EAC5B,IAAIC,EAAiB,CAAC,EACtB,IAAIC,EACJ,IAAIC,EACJ,IAAIC,EACJ,IAAIC,EAAmB,CACtBC,qBAAsB,CACrBC,gBAAiBnB,EACjBoB,eAAgB,IAEjBC,QAAS,CACRF,gBAAiBlB,EACjBmB,eAAgB,CAAC,YAElBE,SAAU,CACTH,gBAAiBhB,EACjBiB,eAAgB,CAAC,WAAY,iBAAkB,iCAAkC,6BAElFG,aAAc,CACbJ,gBAAiBjB,EACjBkB,eAAgB,CAAC,gBAAiB,wBAAyB,uBAAwB,kBAKrF,IAAII,EAAiB,CACpBD,aAAc,CAAC,EACfD,SAAU,CAAC,GAGZ,SAASG,EAAmBC,GAC3B,IAAIC,EAAa5B,EAAU6B,IAAIF,EAAaG,aAC5CH,EAAaI,cAAgBJ,EAAaI,eAAiBH,EAAWI,oBAAsB,CAAC,EAC7FL,EAAaM,SAAWN,EAAaM,UAAYN,EAAaO,aAAeN,EAAWO,oBACxFR,EAAaS,UAAYT,EAAaS,WAAa9B,EAAc+B,iBAAiBV,EACnF,CAEA,SAASW,EAA6BC,EAAYC,GACjD,IAAK5B,EAAY2B,GAAa,CAC7B,MAAM,IAAIE,MAAM,+BACjB,CAEA,IAAK7B,EAAY2B,GAAYG,aAAaF,GAAW,CACpD,IAAK5B,EAAY2B,GAAYI,gBAAiB,CAC7C/B,EAAY2B,GAAYI,gBAAkBC,EAAiBhC,EAAY2B,GAAYM,0BACpF,CACA,IAAIlB,EAAe,CAClBkB,0BAA2BjC,EAAY2B,GAAYM,0BACnDF,gBAAiB/B,EAAY2B,GAAYI,gBACzCb,YAAalB,EAAY2B,GAAYT,YACrCC,cAAenB,EAAY2B,GAAYR,cACvCK,UAAWG,GAEZ3B,EAAY2B,GAAYG,aAAaF,GAAY7B,EAAUmC,oBAAoBN,EAAUb,EAC1F,CAEA,OAAOf,EAAY2B,GAAYG,aAAaF,EAC7C,CAEA,SAASO,EAAoBR,GAC5B,OAAOD,EAA6BC,EAAY,uBACjD,CAEA,SAASS,EAAcT,GACtB,OAAOD,EAA6BC,EAAY,UACjD,CAEA,SAASU,EAAeV,GACvB,OAAOD,EAA6BC,EAAY,WACjD,CAEA,SAASW,EAAmBX,GAC3B,OAAOD,EAA6BC,EAAY,eACjD,CAEA,SAASY,EAAgCxB,GACxC,GAAIA,EAAaS,UAAUgB,SAAS,cAAe,CAClD,IAAIC,EAAS1B,EAAaS,UAAUkB,MAAM,KAC1CD,EAAOE,MACP,IAAIC,EAA6BH,EAAOI,KAAK,KAC7C7C,EAAY4C,GAA8B3D,EAAM,CAAC,EAAG,CACnD8C,gBAAiB,CAACrB,QAASf,EAAamD,4BACxCb,0BAA2B,CAACvB,QAASf,EAAamD,4BAClDhB,aAAc,CAAC,EACfZ,YAAaH,EAAaG,YAC1B6B,iBAAkBhC,EAAagC,mBAEhC7C,EAAe0C,GAA8B1C,EAAea,EAAaS,UAC1E,CACD,CAGA,SAASQ,EAAiBgB,GACzB,IAAIC,EAAkBhE,EAAM,CAAC,EAAG+D,GAChC,IAAIE,EAAeD,EAAgBvC,QACnC,IAAIyC,EAAqBC,EAAiB,cAC1C,GAAIxD,EAAWyD,yBAAyBF,GAAqB,CAC5DnE,EAAKsB,EAAkB,SAASgD,EAAQC,GACvCA,EAAgB9C,eAAe+C,QAAQ,SAASC,GAC/CvE,EAAWwE,IAAID,EAAO7D,EAAW+D,kCAAkCzE,EAAW+B,IAAIwC,EAAOP,GAAeC,GAAqBD,EAC9H,EACD,EACD,CACA,OAAOD,CACR,CAEA,SAASW,EAAa7C,GACrBb,EAAea,EAAaS,WAAa/B,EAAOmE,aAAa7C,GAC3D8C,KAAK,SAASb,GACdhD,EAAYe,EAAaS,WAAavC,EAAM,CAAC,EAAG,CAC/CgD,0BAA2Be,EAC3BlB,aAAc,CAAC,EACfZ,YAAaH,EAAaG,YAC1BC,cAAeJ,EAAaI,cAC5B4B,iBAAkBhC,EAAagC,mBAKhCR,EAAgCxB,GAChC+C,EAAwB/C,EAAaS,WACrCuC,EAAyBhD,EAAaS,UAAWwB,GAMjD,OAAOA,CACR,GAED,OAAO9C,EAAea,EAAaS,UACpC,CAEA,SAASuC,EAAyBpC,EAAYqB,GAC7C,IAAIgB,EAAYhB,GAAaA,EAAUtC,SAAW,CAAC,EACnD,GAAIsD,EAAUC,OAASC,UAAW,CACjC,IAAIC,EAAmBrE,EAAgBsE,eAAezC,GACtD,GAAIwC,IAAqB,KAAM,CAC9BA,EAAmB,CAAC,CACrB,CACAA,EAAiBE,oBAAsBL,EAAUC,KAAKI,oBACtDvE,EAAgBwE,eAAeH,EAAkBxC,EAClD,CACD,CAEA,SAASmC,EAAwBnC,GAChC,IAAI4C,EAA0BnB,EAAiB,mBAC/C,GAAImB,IAA4BtE,EAAqB0B,GAAa,CACjE1B,EAAqB0B,GAAc6C,EAAqBC,KAAK,KAAM9C,GACnE4C,EAAwBG,yBAAyBzE,EAAqB0B,GACvE,CACD,CAEA,SAASgD,EAA0BhD,GAClC,IAAI4C,EAA0BnB,EAAiB,mBAC/C,GAAImB,EAAyB,CAC5B,GAAItE,EAAqB0B,GAAa,CACrC4C,EAAwBK,2BAA2B3E,EAAqB0B,WACjE1B,EAAqB0B,EAC7B,CACD,CACD,CAEA,SAAS6C,EAAqB7C,EAAYkD,EAAUC,GACnD,IAAIP,EAA0BnB,EAAiB,mBAC/C,GAAImB,EAAyB,CAC5B,IACC,IAAIQ,EAAmBnF,EAAWoF,8BAA8BH,EAAUzB,EAAiB,eAC3F,IAAI6B,EAAoBrF,EAAWoF,8BAA8BF,EAAU1B,EAAiB,eAC5F,GAAI2B,IAAqBE,EAAmB,CAC3ClF,EAAUmF,sBAAsBvD,EACjC,CAID,CAHE,MAAOwD,GAERhG,EAAIiG,MAAMD,EAAOE,QAClB,CACA,OAAOd,EAAwBe,uBAAuBC,QACvD,CACA,OAAOrB,SACR,CAEA,SAASsB,EAAsBC,GAC9B,IAAIC,EAAgB1F,EAAYyF,EAAgBjE,WAChD,GAAIkE,EAAc3C,mBAAqB,MAAQ0C,EAAgB1C,mBAAqB,KAAM,CACzF2C,EAAc3C,iBAAmB,MACjC0C,EAAgBE,gBAAkB1G,EAAM,CAAC,EAAGyG,EAAczD,0BAA0BvB,SACpF+E,EAAgBG,aAAe,IAChC,CACA,OAAOH,CACR,CAEA,SAASI,EAAiBJ,GACzB,IAAIK,EAA2B9F,EAAYyF,EAAgBjE,WAAWN,YAEtE,IAAKuE,EAAgBG,cAAgBE,IAA6BL,EAAgBvE,YAAa,CAC9FuE,EAAgBG,aAAe,IAChC,CACA,OAAOH,CACR,CAEA,SAASM,IACR,OAAOC,QAAQC,IAAI,CAClBpG,EAAMuD,iBAAiB,mBACvBvD,EAAMuD,iBAAiB,gBAEtBS,KAAK,SAASqC,GACd/F,EAA2B+F,EAAU,GACrC9F,EAAsB8F,EAAU,EACjC,GACCC,MAAM,SAAShB,GACfhG,EAAIiG,MAAM,6CAA+CD,EAAOE,QACjE,EACF,CAEA,SAASjC,EAAiBgD,GACzB,GAAIvG,EAAMwG,qBAAsB,CAC/B,GAAID,IAAiB,kBAAmB,CACvC,OAAOjG,CACR,MAAO,GAAIiG,IAAiB,aAAc,CACzC,OAAOhG,CACR,CACD,CACA,OAAO8D,SACR,CAIA,SAASoC,IACR,OAAON,QAAQC,IAAI,CAClBpG,EAAM0G,aAAa,wCAElB1C,KAAK,SAAS2C,GACdnG,EAA6BmG,EAAS,EACvC,GACCL,MAAM,SAAShB,GACfhG,EAAIiG,MAAM,0BAA4BD,EAAOE,QAC9C,EACF,CAiBAtF,EAAU0G,WAAa,SAAS1F,GAC/B,OAAOiF,QAAQC,IAAI,CAClBF,IACAO,MAECzC,KAAK,WACL/C,EAAmBC,GACnB,IAAI2F,EAAiB3F,EAAaS,UAElC,GAAItB,EAAewG,GAAiB,CACnC,OAAOxG,EAAewG,GACpB7C,KAAK2B,EAAsBf,KAAK,KAAM1D,IACtC8C,KAAKgC,GACLhC,KAAK,SAAS8C,GACd,OAAOA,EAAqBf,aACzBhC,EAAa+C,GACb3G,EAAY0G,GAAgBzE,yBAChC,EACF,CAEA,OAAO2B,EAAa7C,EACrB,GACC8C,KAAK,SAAS9C,GACd,IAAKf,EAAYe,EAAaS,WAAWL,cAAe,CACvD,IAAIH,EAAa5B,EAAU6B,IAAIF,EAAaG,aAC5ClB,EAAYe,EAAaS,WAAWL,cAAgBH,EAAaA,EAAWI,mBAAqBL,EAAaI,aAC/G,CACD,EAAEsD,KAAK,KAAM1D,GACf,EAaAhB,EAAU6G,mBAAqB,SAAS7F,GACvCD,EAAmBC,GAEnBhB,EAAU8G,WAAW9F,EAAaS,WAClCzB,EAAU8G,WAAWhH,EAAMiH,mBAAmB/F,EAAaS,YAE3D,OAAOzB,EAAU0G,WAAW1F,EAC7B,EAEAhB,EAAU8G,WAAa,SAASlF,GAC/B,GAAIA,EAAY,CACfgD,EAA0BhD,UACnB3B,EAAY2B,UACZzB,EAAeyB,GAGtB,GACCtB,IACIA,EAA2B0G,gBAAkB,CAAC,GAAGC,eAAerF,GACnE,CACDtB,EAA2B0G,eAAepF,GAAYsF,oBACvD,CACD,KAAO,CACNC,OAAOC,KAAKnH,GAAawD,QAAQ,SAAS7B,GACzCgD,EAA0BhD,EAC3B,GACA3B,EAAc,CAAC,EACfE,EAAiB,CAAC,CACnB,CACD,EAEAH,EAAUqH,+BAAiC,SAASzF,EAAY0F,EAAiBC,EAAkBC,GAClG1G,EAAeD,aAAae,GAAcd,EAAeD,aAAae,IAAe,CAAC,EACtFd,EAAeD,aAAae,GAAY0F,GAAmB,CAAC,EAC5DxG,EAAeD,aAAae,GAAY0F,GAAiBG,gBAAkBF,EAC3EzG,EAAeD,aAAae,GAAY0F,GAAiB1G,SAAW4G,CACrE,EAEAxH,EAAU0H,+BAAiC,SAAS9F,GACnD,OAAOd,EAAeD,aAAae,EACpC,EAEA5B,EAAU2H,uBAAyB,SAAS/F,EAAYgG,EAAcL,GACrE,IAAIM,EAAe7H,EAAU8H,iBAAiBlG,GAC9C,IAAKiG,EAAaV,OAAOC,KAAKG,GAAkB,IAAK,CACpDrI,EAAM2I,EAAcN,GAEpBzG,EAAeF,SAASgB,GAAcd,EAAeF,SAASgB,IAAe,CAAC,EAC9Ed,EAAeF,SAASgB,GAAYgG,GAAgB9G,EAAeF,SAASgB,GAAYgG,IAAiB,CAAC,EAC1G1I,EAAM4B,EAAeF,SAASgB,GAAYgG,GAAeL,EAC1D,CACD,EAEAvH,EAAU+H,2BAA6B,SAASnG,EAAYgG,GAC3D,GAAI9G,EAAeF,SAASgB,GAAa,QACjCd,EAAeF,SAASgB,GAAYgG,EAC5C,CACD,EAQA5H,EAAUmF,sBAAwB,SAASvD,GAC1C,GAAI3B,EAAY2B,GAAa,CAC5B3B,EAAY2B,GAAYG,aAAe,CAAC,SACjC9B,EAAY2B,GAAYI,eAChC,CACD,EAEAhC,EAAUgI,aAAe,SAASpG,GACjC,OAAOS,EAAcT,GAAYjB,OAClC,EAEAX,EAAUiI,wBAA0B,SAASrG,GAC5C,OAAOQ,EAAoBR,GAAYpB,oBACxC,EAEAR,EAAU8H,iBAAmB,SAASlG,GACrC,IAAIiG,EAAevF,EAAeV,GAClC,GAAId,EAAeF,SAASgB,GAAa,CACxC3C,EAAK6B,EAAeF,SAASgB,GAAa,SAASgG,EAAcM,GAGhE,GAAIjI,EAAY2B,GAAYT,cAAgByG,EAAc,CACzD3I,EAAKiJ,EAAU,SAASC,EAA6BC,GACpD,IAAKP,EAAaM,GAA8B,CAC/CN,EAAaM,GAA+BC,CAC7C,CACD,EACD,CACD,EACD,CACA,OAAOP,CACR,EAEA7H,EAAUqI,sBAAwB,SAASzG,GAC1C,OAAO3B,EAAY2B,GAAYM,0BAA0BvB,QAAQ2H,kBAClE,EAEAtI,EAAUuC,mBAAqB,SAASX,GACvC,OAAOW,EAAmBX,EAC3B,EAEA5B,EAAUmC,oBAAsB,SAASN,EAAUb,GAClD,OAAOT,EAAiBsB,GAAUpB,gBAAgBO,EACnD,EAGAhB,EAAUuI,mBAAqB,SAAS3G,GACvC,GAAIzB,EAAeyB,GAAa,CAC/B,OAAOzB,EAAeyB,GAAYkC,KAAK,WACtC,OAAO7D,EAAY2B,GAAYM,yBAChC,EACD,CACA,OAAO+D,QAAQuC,SAChB,EAGAxI,EAAUyI,kCAAoC,SAAS7G,GACtD,OAAO3B,EAAY2B,IAAe3B,EAAY2B,GAAYM,0BAA0BvB,OACrF,EAEA,OAAOX,CACR"}