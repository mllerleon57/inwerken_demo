{"version":3,"file":"FlexController.js","names":["sap","ui","define","ChangeHandlerStorage","Utils","Layer","Change","ChangePersistenceFactory","Versions","Applier","Reverter","URLHandler","JsControlTreeModifier","XmlTreeModifier","Component","Log","revertChangesAndUpdateVariantModel","oComponent","bSkipUrlUpdate","aChanges","Promise","resolve","then","length","reverse","revertMultipleChanges","appComponent","modifier","flexController","this","bind","oModel","getModel","VARIANT_MODEL_NAME","forEach","oChange","sVariantReference","getVariantReference","removeChange","update","parameters","updateURL","updateHashEntry","model","FlexController","sComponentName","_oChangePersistence","undefined","_sComponentName","getChangePersistenceForComponent","getComponentName","prototype","setVariantSwitchPromise","oPromise","_oVariantSwitchPromise","waitForVariantSwitch","createBaseChange","oChangeSpecificData","oAppComponent","oChangeFileContent","Error","reference","packageName","createInitialFileContent","variantReference","setVariantReference","_createChange","oControl","sControlType","controlType","getControlType","getChangeHandler","getChangeType","getLayer","oChangeHandler","completeChangeContent","view","getViewForControl","JSON","stringify","setState","states","NEW","catch","oError","reject","createChangeWithExtensionPointSelector","mExtensionPointReference","oView","getAppComponentForControl","selector","name","viewSelector","getSelector","getId","createChangeWithControlSelector","FakePromise","sControlId","id","Object","assign","addChange","_ignoreOnce","addPreparedChange","setQueuedForApply","deleteChange","applyChange","mPropertyBag","applyChangeOnControl","oReturn","success","oException","error","checkDependencies","mDependencies","mChanges","aRelevantChanges","bResult","canChangePotentiallyBeApplied","push","sDependencyKey","aDependentChanges","dependencies","i","n","oDependentChange","getChangeFromChangesMap","aSelectors","getDependentControlSelectorList","some","oSelector","bySelector","waitForChangesToBeApplied","aPromises","map","mSelector","_waitForChangesToBeApplied","all","filterChanges","isCurrentProcessFinished","changeTypes","includes","getCore","byId","mChangesMap","getChangesMapForComponent","aChangesForControl","aNotYetProcessedChanges","filter","indexOf","concat","addChangeProcessingPromises","_removeOtherLayerChanges","sLayer","bRemoveOtherLayerChanges","aLayersToReset","values","sLayerToCheck","removeDirtyChanges","saveAll","bSkipUpdateCache","bDraft","sParentVersion","aDraftFilenames","oVersionModel","getVersionsModel","normalizeReference","layer","CUSTOMER","getProperty","saveDirtyChanges","oResult","response","vChangeDefinition","Array","isArray","onAllChangesSaved","processXmlView","oViewComponent","get","componentId","getChangesForView","applyAllChangesForXMLView","handleXMLApplyError","getComponentChanges","bInvalidateCache","getChangesForComponent","getOpenDependentChangesForControl","resetChanges","sGenerator","aSelectorIds","aChangeTypes","vLayer","applyVariantChanges","reduce","oPreviousPromise","_addRunTimeCreatedChangeAndUpdateDependencies","saveSequenceOfDirtyChanges","aDirtyChanges"],"sources":["FlexController-dbg.js"],"mappings":"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"}