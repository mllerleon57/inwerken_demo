/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["../utils/TableUtils","../library","sap/ui/base/Object","sap/ui/Device","sap/ui/events/KeyCodes","sap/ui/thirdparty/jquery"],function(e,t,i,o,n,jQuery){"use strict";var s=e.CELLTYPE;var r=t.SelectionMode;var l={CTRL:1,SHIFT:2,ALT:4};var a=5;var f="1rem";function u(e,t){e.setMarked("sapUiTableSkipItemNavigation",t!==false)}function g(t){if(e.getCellInfo(t.target).isOfType(s.ANY)){t.preventDefault();t.stopPropagation()}}var c=i.extend("sap.ui.table.extensions.KeyboardDelegate",{constructor:function(e){i.call(this)},destroy:function(){i.prototype.destroy.apply(this,arguments)},getInterface:function(){return this}});function d(t,i){if(!h(t,i)){return}var o=e.getCellInfo(e.getCell(t,i.target));if(o.isOfType(s.ANYCOLUMNHEADER)){v(t,o,i)}else if(o.isOfType(s.ANYCONTENTCELL)){C(t,o,i)}}function v(t,i,o){var n=e.getHeaderRowCount(t);if(e.isNoDataVisible(t)){var r=e.getFocusedItemInfo(t);if(r.row-n<=1){u(o)}}else if(i.isOfType(s.COLUMNROWHEADER)&&n>1){u(o);e.focusItem(t,n*(e.getVisibleColumnCount(t)+1),o)}}function C(t,i,o){var n=t._getKeyboardExtension();var s=n.isInActionMode();var r=c._isKeyCombination(o,null,l.CTRL);var a=r||s;var f=e.getParentCell(t,o.target);if(!a&&f){f.trigger("focus");return}u(o);if(e.isLastScrollableRow(t,i.cell)){var g=E(t,o);if(g){o.preventDefault();return}}if(i.rowIndex===t.getRows().length-1){if(!s&&f){f.trigger("focus")}else{var d=t.getCreationRow();if(!d||!d._takeOverKeyboardHandling(o)){n.setActionMode(false)}}return}D(t,i.type,i.rowIndex+1,i.columnIndex,a);o.preventDefault()}function p(t,i){var o=e.getCellInfo(e.getCell(t,i.target));if(!o.isOfType(s.ANYCONTENTCELL)||!h(t,i)){return}var n=c._isKeyCombination(i,null,l.CTRL);var r=t._getKeyboardExtension();var a=r.isInActionMode();var f=n||a;var g=e.getParentCell(t,i.target);if(!f&&g){g.trigger("focus");return}u(i);if(e.isFirstScrollableRow(t,o.cell)){var d=m(t,i);if(d){i.preventDefault();return}}if(o.rowIndex===0){u(i,o.isOfType(s.ROWACTION)||f);if(!a&&g){g.trigger("focus")}else{r.setActionMode(false)}return}D(t,o.type,o.rowIndex-1,o.columnIndex,f);i.preventDefault()}function h(e,t){var i=c._isKeyCombination(t,null,l.CTRL);return!t.isMarked()&&(i||!(t.target instanceof window.HTMLInputElement)&&!(t.target instanceof window.HTMLTextAreaElement))}function I(t,i){if(i.isMarked()){return}var o=e.getCellInfo(e.getCell(t,i.target));var n=sap.ui.getCore().getConfiguration().getRTL();if(!o.isOfType(s.COLUMNHEADER)||!n){return}var r=e.getFocusedItemInfo(t);var l=r.cellInRow-(e.hasRowHeader(t)?1:0);var a=e.getVisibleColumnCount(t);if(e.hasRowActions(t)&&l===a-1){u(i)}}function E(e,t,i,o){var n=e._getFirstRenderedRowIndex()===e._getMaxFirstRenderedRowIndex();if(n){return null}T(e,t,true,i,o);return true}function m(e,t,i,o){var n=e._getFirstRenderedRowIndex()===0;if(n){return false}T(e,t,false,i,o);return true}function T(t,i,o,n,r){var a=e.getCellInfo(e.getCell(t,i.target));var f=t._getKeyboardExtension().isInActionMode();var u=c._isKeyCombination(i,null,l.CTRL);var g=u||f;var d=f&&a.isOfType(s.DATACELL);if(d){t._getKeyboardExtension().setSilentFocus(t.getDomRef("focusDummy"));setTimeout(function(){t._getScrollExtension().scrollVertically(o===true,n)},0)}else{t._getScrollExtension().scrollVertically(o===true,n)}if(g||r){t.attachEventOnce("rowsUpdated",function(){if(r){r()}else{D(t,a.type,a.rowIndex,a.columnIndex,true)}})}}function R(e,t){var i=e._getRowCounts();var o=E(e,t,false,function(){y(e,i.fixedTop+i.scrollable-1)});if(o){return}if(i.fixedBottom>0){y(e,i.fixedTop+i.scrollable)}else{e._getKeyboardExtension().setActionMode(false)}}function y(t,i){var o=t.getRows()[i];var n=o.isGroupHeader()||e.isRowSelectorSelectionAllowed(t);if(n){D(t,s.ROWHEADER,i)}else{var r=c._getFirstInteractiveElement(o);if(r){c._focusElement(t,r[0])}else{D(t,s.DATACELL,i,0,false,true);if(o.getIndex()===t._getTotalRowCount()-1){t._getKeyboardExtension().setActionMode(false)}}}}function A(e,t){var i=e._getRowCounts();var o=m(e,t,false,function(){O(e,i.fixedTop)});if(o){return}if(i.fixedTop>0){O(e,i.fixedTop-1)}else{e._getKeyboardExtension().setActionMode(false)}}function O(t,i){var o=t.getRows()[i];var n=o.isGroupHeader()||e.isRowSelectorSelectionAllowed(t);var r=c._getLastInteractiveElement(o);if(r){c._focusElement(t,r[0])}else if(n){D(t,s.ROWHEADER,i)}else{D(t,s.DATACELL,i,0,false,true);if(o.getIndex()===0){t._getKeyboardExtension().setActionMode(false)}}}function x(t,i){var o=e.getFocusedItemInfo(t);var n=t._getKeyboardExtension().getLastFocusedCellInfo();e.focusItem(t,o.cellInRow+o.columnCount*n.row,i)}function _(t,i){var o=e.getFocusedItemInfo(t);e.focusItem(t,o.cellInRow,i)}function w(e,t){e._getKeyboardExtension().setSilentFocus(e.$().find("."+t))}c._isKeyCombination=function(e,t,i){if(i==null){i=0}var s=typeof t==="string"?String.fromCharCode(e.charCode):e.keyCode;var r=0;r|=(o.os.macintosh?e.metaKey:e.ctrlKey)&&t!==n.CONTROL?l.CTRL:0;r|=e.shiftKey&&t!==n.SHIFT?l.SHIFT:0;r|=e.altKey&&t!==n.ALT?l.ALT:0;var a=t==null||s===t;var f=i===r;return a&&f};function L(t,i){var o=e.getCell(t,i);var n=e.getCellInfo(o);return t.getRows()[n.rowIndex]}function b(t,i){var o=e.getCellInfo(i.target);if(o.isOfType(s.COLUMNROWHEADER)){t._getSelectionPlugin().onHeaderSelectorPress()}else if(c._allowsToggleExpandedState(t,i.target)){L(t,i.target).toggleExpandedState()}else if(o.isOfType(s.ROWHEADER)){l()}else if(o.isOfType(s.DATACELL|s.ROWACTION)){var n=!t.hasListeners("cellClick");if(!t._findAndfireCellEvent(t.fireCellClick,i)){if(e.isRowSelectionAllowed(t)){l();n=false}}if(n){var r=e.getInteractiveElements(i.target);if(r){t._getKeyboardExtension().setActionMode(true)}}}function l(){var o=null;if(t._legacyMultiSelection){o=function(e){t._legacyMultiSelection(e,i);return true}}e.toggleRowSelection(t,i.target,null,o)}}function N(t,i){var o=t.getParent();var n=o._getVisibleColumns();var s=n.indexOf(t);var r;if(i&&s<n.length-1){r=o.indexOfColumn(n[s+1])+1}else if(!i&&s>0){r=o.indexOfColumn(n[s-1])}if(r!=null){e.Column.moveColumnTo(t,r)}}function S(e,t){var i=e.getColumns().filter(function(e){return e.getVisible()||e.getGrouped()});for(var o=0;o<i.length;o++){var n=i[o];if(n===t){return o}}return-1}c._focusElement=function(e,t,i){if(!e||!t){return}if(i==null){i=false}if(i){e._getKeyboardExtension().setSilentFocus(t)}else{t.focus()}if(t instanceof window.HTMLInputElement){t.select()}};function D(t,i,o,n,r,l){if(!t||i==null||o==null||o<0||o>=t.getRows().length){return}var a=t.getRows()[o];var f;if(i===s.ROWHEADER){t._getKeyboardExtension().setFocus(t.getDomRef("rowsel"+o));return}else if(i===s.ROWACTION){f=t.getDomRef("rowact"+o)}else if(i===s.DATACELL&&(n!=null&&n>=0)){var u=t.getColumns()[n];var g=S(t,u);if(g>=0){f=a.getDomRef("col"+g)}}if(!f){return}if(r){var d=e.getInteractiveElements(f);if(d){c._focusElement(t,d[0]);return}}if(l){t._getKeyboardExtension()._bStayInActionMode=true}f.focus()}function M(e){return e.classList.contains("sapUiTableTreeIconNodeOpen")||e.classList.contains("sapUiTableTreeIconNodeClosed")}c._allowsToggleExpandedState=function(t,i){return e.Grouping.isInGroupHeaderRow(i)||e.Grouping.isInTreeMode(t)&&i.classList.contains("sapUiTableCellFirst")&&(i.querySelector(".sapUiTableTreeIconNodeOpen")||i.querySelector(".sapUiTableTreeIconNodeClosed"))||M(i)};c._isElementInteractive=function(t){if(!t){return false}return jQuery(t).is(e.INTERACTIVE_ELEMENT_SELECTORS)};c._getFirstInteractiveElement=function(t){var i=e.getFirstInteractiveElement(t,true);if(!i){return null}return jQuery(i)};c._getLastInteractiveElement=function(t){if(!t){return null}var i=t.getParent();var o=t.getCells();var n;var s;if(e.hasRowActions(i)){o.push(t.getRowAction())}for(var r=o.length-1;r>=0;r--){n=e.getParentCell(i,o[r].getDomRef());s=e.getInteractiveElements(n);if(s){return s.last()}}return null};c._getPreviousInteractiveElement=function(t,i){if(!t||!i){return null}var o=jQuery(i);if(!this._isElementInteractive(o)){return null}var n=e.getParentCell(t,i);var r;var l;var a;var f;var u;var g;var c;r=e.getInteractiveElements(n);if(r[0]!==o[0]){return r.eq(r.index(i)-1)}l=e.getCellInfo(n);f=t.getRows()[l.rowIndex].getCells();if(l.isOfType(s.ROWACTION)){c=f.length-1}else{u=t.getColumns()[l.columnIndex];g=S(t,u);c=g-1}for(var d=c;d>=0;d--){a=f[d].getDomRef();n=e.getParentCell(t,a);r=e.getInteractiveElements(n);if(r){return r.last()}}return null};c._getNextInteractiveElement=function(t,i){if(!t||!i){return null}var o=jQuery(i);if(!this._isElementInteractive(o)){return null}var n=e.getParentCell(t,i);var r;var l;var a;var f;var u;var g;var c;r=e.getInteractiveElements(n);if(r.get(-1)!==o[0]){return r.eq(r.index(i)+1)}l=e.getCellInfo(n);if(l.isOfType(s.ROWACTION)){return null}g=t.getRows()[l.rowIndex];f=g.getCells();u=t.getColumns()[l.columnIndex];c=S(t,u);for(var d=c+1;d<f.length;d++){a=f[d].getDomRef();n=e.getParentCell(t,a);r=e.getInteractiveElements(n);if(r){return r.first()}}if(e.hasRowActions(t)){n=e.getParentCell(t,g.getRowAction().getDomRef());r=e.getInteractiveElements(n);if(r.get(-1)!==o[0]){return r.eq(r.index(i)+1)}}return null};function K(t){var i=e.getRowIndexOfFocusedCell(t);var o=t.getRows()[i].getIndex();var n=t._getSelectionPlugin();t._oRangeSelection={startIndex:o,selected:n.isIndexSelected(o)}}c.prototype.enterActionMode=function(){var t=this._getKeyboardExtension();var i=document.activeElement;var o=e.getInteractiveElements(i);var n=e.getParentCell(this,i);var r=e.getCellInfo(n);if(r.isOfType(s.ANYCOLUMNHEADER)){return false}if(o){t.suspendItemNavigation();i.tabIndex=-1;c._focusElement(this,o[0],true);return true}else if(n){this._getKeyboardExtension().suspendItemNavigation();return true}return false};c.prototype.leaveActionMode=function(t){t=t==null?true:t;var i=this._getKeyboardExtension();var o=document.activeElement;var n=e.getParentCell(this,o);i.resumeItemNavigation();if(t){if(n){c._focusElement(this,n[0],true)}else{var s=this._getItemNavigation();if(s){var r=s.aItemDomRefs;var l=r.indexOf(o);if(l>-1){s.setFocusedIndex(l)}}i.setSilentFocus(o)}}};c.prototype.onfocusin=function(t){if(t.isMarked("sapUiTableIgnoreFocusIn")){return}var i=jQuery(t.target);if(i.hasClass("sapUiTableOuterBefore")||i.hasClass("sapUiTableOuterAfter")||t.target!=this.getDomRef("overlay")&&this.getShowOverlay()){this.$("overlay").trigger("focus")}else if(i.hasClass("sapUiTableCtrlBefore")){var o=e.isNoDataVisible(this);if(!o||o&&this.getColumnHeaderVisible()){_(this,t)}else{this._getKeyboardExtension().setSilentFocus(this.$("noDataCnt"))}}else if(i.hasClass("sapUiTableCtrlAfter")){if(!e.isNoDataVisible(this)){x(this,t)}}var n=e.getCellInfo(t.target);var r=n.isOfType(s.ROWHEADER)&&e.Grouping.isInGroupHeaderRow(t.target);var l=n.isOfType(s.ROWHEADER)&&!r&&e.isRowSelectorSelectionAllowed(this);var a=n.isOfType(s.DATACELL)&&this._getKeyboardExtension()._bStayInActionMode;var f=e.getCellInfo(e.getParentCell(this,t.target)).isOfType(s.ANYCONTENTCELL);var u=c._isElementInteractive(t.target);var g=this._getKeyboardExtension().isInActionMode();var d=g&&(r||l||a)||u&&f;if(a){this._getKeyboardExtension()._bStayInActionMode=false}this._getKeyboardExtension().setActionMode(d,false)};c.prototype.onkeydown=function(t){if(t.isMarked()){return}var i=this._getKeyboardExtension();var o=e.getCellInfo(t.target);var a=this.getSelectionMode();var f=this._getSelectionPlugin();if(c._isKeyCombination(t,n.F2)){var u=i.isInActionMode();var g=e.getCell(this,t.target);var d=e.getParentCell(this,t.target)!=null;o=e.getCellInfo(g);if(!u&&d){g.trigger("focus")}else if(o.isOfType(s.ANYCOLUMNHEADER)){var v=e.getInteractiveElements(g);if(v){v[0].focus()}}else{i.setActionMode(!u)}return}if(c._isKeyCombination(t,n.F4)&&c._allowsToggleExpandedState(this,t.target)){L(this,t.target).toggleExpandedState();return}if(c._isKeyCombination(t,n.SPACE)&&M(t.target)){t.preventDefault();return}if(this._getKeyboardExtension().isInActionMode()||!o.isOfType(s.ANY)){return}if(c._isKeyCombination(t,n.SPACE)){t.preventDefault()}if(c._isKeyCombination(t,n.SHIFT)&&a===r.MultiToggle&&(o.isOfType(s.ROWHEADER)&&e.isRowSelectorSelectionAllowed(this)||o.isOfType(s.DATACELL|s.ROWACTION))){K(this)}else if(c._isKeyCombination(t,n.A,l.CTRL)){t.preventDefault();if(o.isOfType(s.ANYCONTENTCELL|s.COLUMNROWHEADER)&&a===r.MultiToggle){f.onKeyboardShortcut("toggle")}}else if(c._isKeyCombination(t,n.A,l.CTRL+l.SHIFT)){if(o.isOfType(s.ANYCONTENTCELL|s.COLUMNROWHEADER)){f.onKeyboardShortcut("clear")}}else if(c._isKeyCombination(t,n.F4)){if(o.isOfType(s.DATACELL)){i.setActionMode(true)}}};c.prototype.onkeypress=function(t){if(t.isMarked()){return}var i=this._getKeyboardExtension();var o=e.getCellInfo(t.target);if(c._isKeyCombination(t,"+")){if(c._allowsToggleExpandedState(this,t.target)){L(this,t.target).expand()}else if(o.isOfType(s.DATACELL|s.ROWACTION)){i.setActionMode(true)}}else if(c._isKeyCombination(t,"-")){if(c._allowsToggleExpandedState(this,t.target)){L(this,t.target).collapse()}else if(o.isOfType(s.DATACELL|s.ROWACTION)){i.setActionMode(true)}}};c.prototype.oncontextmenu=function(t){if(t.isMarked("handledByPointerExtension")){return}var i=e.getCellInfo(document.activeElement);if(i.isOfType(s.ANY)){t.preventDefault();e.Menu.openContextMenu(this,t.target,t)}};c.prototype.onkeyup=function(t){if(t.isMarked()){return}var i=e.getCellInfo(t.target);if(c._isKeyCombination(t,n.SHIFT)){delete this._oRangeSelection}if(i.isOfType(s.COLUMNHEADER)){if(c._isKeyCombination(t,n.SPACE)||c._isKeyCombination(t,n.ENTER)){e.Menu.openContextMenu(this,t.target)}}else if(c._isKeyCombination(t,n.SPACE)){b(this,t)}else if(c._isKeyCombination(t,n.SPACE,l.SHIFT)){e.toggleRowSelection(this,this.getRows()[i.rowIndex].getIndex());K(this)}else if(this._legacyMultiSelection&&!i.isOfType(s.COLUMNROWHEADER)&&(c._isKeyCombination(t,n.SPACE,l.CTRL)||c._isKeyCombination(t,n.ENTER,l.CTRL))){b(this,t)}};c.prototype.onsaptabnext=function(t){var i=this._getKeyboardExtension();var o=e.getCellInfo(t.target);var n;if(i.isInActionMode()){var r;n=e.getCell(this,t.target);o=e.getCellInfo(n);if(!o.isOfType(s.ANYCONTENTCELL)){return}var l=this.getRows()[o.rowIndex];var a=c._getLastInteractiveElement(l);var f=a===null||a[0]===t.target;if(f){var u=l.getIndex();var g=e.isLastScrollableRow(this,n);var d=this._getTotalRowCount()-1===u;var v=e.isRowSelectorSelectionAllowed(this);t.preventDefault();if(d){i.setActionMode(false)}else if(g){R(this,t)}else{var C=o.rowIndex;if(v){D(this,s.ROWHEADER,C+1)}else{var p=this.getRows().length;var h=false;for(var I=o.rowIndex+1;I<p;I++){C=I;l=this.getRows()[C];r=c._getFirstInteractiveElement(l);h=l.isGroupHeader();if(r||h){break}}if(r){c._focusElement(this,r[0])}else if(h){D(this,s.ROWHEADER,C)}else{R(this,t)}}}}else if(o.isOfType(s.ROWHEADER)){t.preventDefault();r=c._getFirstInteractiveElement(l);c._focusElement(this,r[0])}else{t.preventDefault();r=c._getNextInteractiveElement(this,t.target);c._focusElement(this,r[0])}}else if(o.isOfType(s.ANYCOLUMNHEADER)){if(e.isNoDataVisible(this)){this.$("noDataCnt").trigger("focus");t.preventDefault()}else if(this.getRows().length>0){x(this,t);t.preventDefault()}}else if(o.isOfType(s.ANYCONTENTCELL)){w(this,"sapUiTableCtrlAfter")}else if(t.target===this.getDomRef("overlay")){i.setSilentFocus(this.$().find(".sapUiTableOuterAfter"))}else if(!o.isOfType(s.ANY)){n=e.getParentCell(this,t.target);if(n){t.preventDefault();n.trigger("focus")}}};c.prototype.onsaptabprevious=function(t){var i=this._getKeyboardExtension();var o=e.getCellInfo(t.target);var n;if(i.isInActionMode()){var r;n=e.getCell(this,t.target);o=e.getCellInfo(n);if(!o.isOfType(s.ANYCONTENTCELL)){return}var l=this.getRows()[o.rowIndex];var a=l.getIndex();var f=c._getFirstInteractiveElement(l);var u=f!==null&&f[0]===t.target;var g=e.isRowSelectorSelectionAllowed(this);var d=g||l.isGroupHeader();if(u&&d){t.preventDefault();D(this,s.ROWHEADER,o.rowIndex)}else if(u&&!d||o.isOfType(s.ROWHEADER)||f===null){var v=e.isFirstScrollableRow(this,n);var C=a===0;t.preventDefault();if(C){i.setActionMode(false)}else if(v){A(this,t)}else{var p=o.rowIndex;var h=false;for(var I=o.rowIndex-1;I>=0;I--){p=I;l=this.getRows()[p];r=c._getLastInteractiveElement(l);h=l.isGroupHeader();if(r||d||h){break}}if(r){c._focusElement(this,r[0])}else if(h||d){D(this,s.ROWHEADER,p)}else{A(this,t)}}}else{t.preventDefault();r=c._getPreviousInteractiveElement(this,t.target);c._focusElement(this,r[0])}}else if(o.isOfType(s.ANYCONTENTCELL)||t.target===this.getDomRef("noDataCnt")){if(this.getColumnHeaderVisible()&&!o.isOfType(s.ROWACTION)){_(this,t);t.preventDefault()}else{w(this,"sapUiTableCtrlBefore")}}else if(t.target===this.getDomRef("overlay")){this._getKeyboardExtension().setSilentFocus(this.$().find(".sapUiTableOuterBefore"))}else if(!o.isOfType(s.ANY)){n=e.getParentCell(this,t.target);if(n){t.preventDefault();n.trigger("focus")}}};c.prototype.onsapdown=function(e){g(e);d(this,e)};c.prototype.onsapdownmodifiers=function(t){g(t);if(c._isKeyCombination(t,null,l.CTRL)){d(this,t);return}var i=this._getKeyboardExtension();if(c._isKeyCombination(t,null,l.ALT)&&c._allowsToggleExpandedState(this,t.target)){u(t);L(this,t.target).expand();return}if(i.isInActionMode()){return}var o=e.getCellInfo(t.target);if(c._isKeyCombination(t,null,l.SHIFT)){if(o.isOfType(s.ANYCONTENTCELL)){if(!this._oRangeSelection){u(t);return}var n=e.getRowIndexOfFocusedCell(this);var r=this.getRows()[n].getIndex();if(r===this._getTotalRowCount()-1){return}if(e.isLastScrollableRow(this,t.target)){var a=E(this,t);if(a){u(t)}}if(this._oRangeSelection.startIndex<=r){r++;if(this._oRangeSelection.selected){e.toggleRowSelection(this,r,true)}else{e.toggleRowSelection(this,r,false)}}else{e.toggleRowSelection(this,r,false)}}else{u(t)}}if(c._isKeyCombination(t,null,l.ALT)){if(o.isOfType(s.DATACELL)){i.setActionMode(true)}u(t)}};c.prototype.onsapup=function(e){g(e);p(this,e)};c.prototype.onsapupmodifiers=function(t){g(t);if(c._isKeyCombination(t,null,l.CTRL)){p(this,t);return}if(c._isKeyCombination(t,null,l.ALT)&&c._allowsToggleExpandedState(this,t.target)){u(t);L(this,t.target).collapse();return}var i=this._getKeyboardExtension();if(i.isInActionMode()){return}var o=e.getCellInfo(t.target);if(c._isKeyCombination(t,null,l.SHIFT)){if(o.isOfType(s.ANYCONTENTCELL)){if(!this._oRangeSelection){u(t);return}var n=e.getRowIndexOfFocusedCell(this);var r=this.getRows()[n].getIndex();if(r===0){u(t);return}if(e.isFirstScrollableRow(this,t.target)){var a=m(this,t);if(a){u(t)}}if(this._oRangeSelection.startIndex>=r){r--;if(this._oRangeSelection.selected){e.toggleRowSelection(this,r,true)}else{e.toggleRowSelection(this,r,false)}}else{e.toggleRowSelection(this,r,false)}}else{u(t)}}if(c._isKeyCombination(t,null,l.ALT)){if(o.isOfType(s.DATACELL)){i.setActionMode(true)}u(t)}};c.prototype.onsapleft=function(e){g(e);I(this,e)};c.prototype.onsapleftmodifiers=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}var i=e.getCellInfo(t.target);var o=sap.ui.getCore().getConfiguration().getRTL();if(c._isKeyCombination(t,null,l.SHIFT)){if(i.isOfType(s.DATACELL)){if(!this._oRangeSelection){u(t);return}var n=e.getFocusedItemInfo(this);var r=e.hasRowHeader(this)&&n.cellInRow===1;if(r&&!e.isRowSelectorSelectionAllowed(this)){u(t)}}else if(i.isOfType(s.ROWACTION)){if(!this._oRangeSelection){u(t)}}else if(i.isOfType(s.ROWHEADER)&&o){if(!e.isRowSelectionAllowed(this)){u(t)}}else if(i.isOfType(s.COLUMNROWHEADER)&&o){u(t)}else if(i.isOfType(s.COLUMNHEADER)){var a=-e.convertCSSSizeToPixel(f);var d=0;if(o){a=a*-1}for(var v=i.columnIndex;v<i.columnIndex+i.columnSpan;v++){d+=e.Column.getColumnWidth(this,v)}e.Column.resizeColumn(this,i.columnIndex,d+a,true,i.columnSpan);u(t)}}else if(c._isKeyCombination(t,null,l.CTRL)){if(i.isOfType(s.COLUMNHEADER)){u(t);N(this.getColumns()[i.columnIndex],o)}}else if(c._isKeyCombination(t,null,l.ALT)){u(t)}};c.prototype.onsaprightmodifiers=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}var i=e.getCellInfo(t.target);var o=sap.ui.getCore().getConfiguration().getRTL();if(c._isKeyCombination(t,null,l.SHIFT)){if(i.isOfType(s.DATACELL)){if(!this._oRangeSelection){u(t)}}else if(i.isOfType(s.ROWHEADER)){if(!e.isRowSelectionAllowed(this)){u(t)}}else if(i.isOfType(s.ROWACTION)&&o){if(!this._oRangeSelection){u(t)}}else if(i.isOfType(s.COLUMNHEADER)){var n=e.convertCSSSizeToPixel(f);var r=0;if(o){n=n*-1}for(var a=i.columnIndex;a<i.columnIndex+i.columnSpan;a++){r+=e.Column.getColumnWidth(this,a)}e.Column.resizeColumn(this,i.columnIndex,r+n,true,i.columnSpan);u(t)}else if(i.isOfType(s.COLUMNROWHEADER)){u(t)}}else if(c._isKeyCombination(t,null,l.CTRL)){if(i.isOfType(s.COLUMNHEADER)){u(t);N(this.getColumns()[i.columnIndex],!o)}}else if(c._isKeyCombination(t,null,l.ALT)){u(t)}};c.prototype.onsaphome=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(e.Grouping.isInGroupHeaderRow(t.target)){u(t);return}var i=e.getCellInfo(t.target);if(i.isOfType(s.DATACELL|s.ROWACTION|s.COLUMNHEADER)){var o=e.getFocusedItemInfo(this);var n=o.cell;var r=o.cellInRow;var l=this.getComputedFixedColumnCount();var a=e.hasRowHeader(this);var f=a?1:0;if(e.hasFixedColumns(this)&&r>l+f){u(t);e.focusItem(this,n-r+l+f,null)}else if(a&&r>1){u(t);e.focusItem(this,n-r+f,null)}}};c.prototype.onsapend=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(e.Grouping.isInGroupHeaderRow(t.target)){u(t);return}var i=e.getCellInfo(t.target);if(i.isOfType(s.ANY)){var o=e.getFocusedItemInfo(this);var n=o.cell;var r=o.columnCount;var l=this.getComputedFixedColumnCount();var a=o.cellInRow;var f=e.hasRowHeader(this);var c=f?1:0;var d=false;if(i.isOfType(s.COLUMNHEADER)&&e.hasFixedColumns(this)){var v=parseInt(i.cell.attr("colspan")||1);if(v>1&&a+v-c===l){d=true}}if(f&&a===0){u(t);e.focusItem(this,n+1,null)}else if(e.hasFixedColumns(this)&&a<l-1+c&&!d){u(t);e.focusItem(this,n+l-a,null)}else if(e.hasRowActions(this)&&i.isOfType(s.DATACELL)&&a<r-2){u(t);e.focusItem(this,n-a+r-2,null)}}};c.prototype.onsaphomemodifiers=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(c._isKeyCombination(t,null,l.CTRL)){var i=e.getCellInfo(t.target);if(i.isOfType(s.ANYCONTENTCELL|s.COLUMNHEADER)){u(t);var o=e.getFocusedItemInfo(this);var n=o.row;if(n>0){var r=o.cell;var a=o.columnCount;var f=e.getHeaderRowCount(this);var d=this._getRowCounts();if(n<f+d.fixedTop){if(i.isOfType(s.ROWACTION)){e.focusItem(this,r-a*(n-f),t)}else{e.focusItem(this,r-a*n,t)}}else if(n>=f+d.fixedTop&&n<f+e.getNonEmptyRowCount(this)-d.fixedBottom){this._getScrollExtension().scrollVerticallyMax(false);if(d.fixedTop>0||i.isOfType(s.ROWACTION)){e.focusItem(this,r-a*(n-f),t)}else{e.focusItem(this,r-a*n,t)}}else{this._getScrollExtension().scrollVerticallyMax(false);e.focusItem(this,r-a*(n-f-d.fixedTop),t)}}}}};c.prototype.onsapendmodifiers=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(c._isKeyCombination(t,null,l.CTRL)){var i=e.getCellInfo(t.target);if(i.isOfType(s.ANY)){var o=e.getFocusedItemInfo(this);var n=o.row;var r=e.getHeaderRowCount(this);var a=e.getNonEmptyRowCount(this);var f=this._getRowCounts();u(t);if(f.fixedBottom===0||n<r+a-1||e.isNoDataVisible(this)&&n<r-1){var d=o.cell;var v=o.columnCount;if(e.isNoDataVisible(this)){e.focusItem(this,d+v*(r-n-1),t)}else if(n<r){if(f.fixedTop>0){e.focusItem(this,d+v*(r+f.fixedTop-n-1),t)}else{this._getScrollExtension().scrollVerticallyMax(true);e.focusItem(this,d+v*(r+a-f.fixedBottom-n-1),t)}}else if(n>=r&&n<r+f.fixedTop){this._getScrollExtension().scrollVerticallyMax(true);e.focusItem(this,d+v*(r+a-f.fixedBottom-n-1),t)}else if(n>=r+f.fixedTop&&n<r+a-f.fixedBottom){this._getScrollExtension().scrollVerticallyMax(true);e.focusItem(this,d+v*(r+a-n-1),t)}else{e.focusItem(this,d+v*(r+a-n-1),t)}}}}};c.prototype.onsappageup=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}var i=e.getCellInfo(t.target);if(i.isOfType(s.ANYCONTENTCELL|s.COLUMNHEADER)){var o=e.getFocusedItemInfo(this);var n=o.row;var r=e.getHeaderRowCount(this);var l=this._getRowCounts();if(l.fixedTop===0&&n>=r||l.fixedTop>0&&n>r){u(t);var a=o.cell;var f=o.columnCount;if(n<r+l.fixedTop){e.focusItem(this,a-f*(n-r),t)}else if(n===r+l.fixedTop){var c=e.getNonEmptyRowCount(this)-l.fixedTop-l.fixedBottom;var d=this.getFirstVisibleRow();m(this,t,true);if(d<c){if(l.fixedTop>0||i.isOfType(s.ROWACTION)){e.focusItem(this,a-f*(n-r),t)}else{e.focusItem(this,a-f*r,t)}}}else if(n>r+l.fixedTop&&n<r+e.getNonEmptyRowCount(this)){e.focusItem(this,a-f*(n-r-l.fixedTop),t)}else{e.focusItem(this,a-f*(n-r-e.getNonEmptyRowCount(this)+1),t)}}if(i.isOfType(s.ROWACTION)&&n===r&&l.fixedTop>0){u(t)}}};c.prototype.onsappagedown=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}var i=e.getCellInfo(t.target);if(i.isOfType(s.ANY)){var o=e.getFocusedItemInfo(this);var n=o.row;var r=e.getHeaderRowCount(this);var l=e.getNonEmptyRowCount(this);var a=this._getRowCounts();u(t);if(e.isNoDataVisible(this)&&n<r-1||a.fixedBottom===0||n<r+l-1){var f=o.cell;var c=o.columnCount;if(n<r-1&&!i.isOfType(s.COLUMNROWHEADER)){e.focusItem(this,f+c*(r-n-1),t)}else if(n<r){if(!e.isNoDataVisible(this)){e.focusItem(this,f+c*(r-n),t)}}else if(n>=r&&n<r+l-a.fixedBottom-1){e.focusItem(this,f+c*(r+l-a.fixedBottom-n-1),t)}else if(n===r+l-a.fixedBottom-1){var d=e.getNonEmptyRowCount(this)-a.fixedTop-a.fixedBottom;var v=this._getTotalRowCount()-a.fixedBottom-this.getFirstVisibleRow()-d*2;E(this,t,true);if(v<d&&a.fixedBottom>0){e.focusItem(this,f+c*(r+l-n-1),t)}}else{e.focusItem(this,f+c*(r+l-n-1),t)}}}};c.prototype.onsappageupmodifiers=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(c._isKeyCombination(t,null,l.ALT)){var i=e.getCellInfo(t.target);var o=e.getFocusedItemInfo(this);if(i.isOfType(s.DATACELL|s.COLUMNHEADER)){var n=o.cell;var r=o.cellInRow;var f=e.hasRowHeader(this);var d=f?1:0;var v=a;u(t);if(f&&(e.Grouping.isInGroupHeaderRow(t.target)||r===1)){e.focusItem(this,n-r,null)}else if(r-d<v){e.focusItem(this,n-r+d,null)}else{e.focusItem(this,n-v,null)}}else if(i.isOfType(s.ROWACTION)){e.focusItem(this,o.cell-1,null)}}};c.prototype.onsappagedownmodifiers=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(c._isKeyCombination(t,null,l.ALT)){var i=e.getCellInfo(t.target);if(i.isOfType(s.DATACELL|s.ROWHEADER|s.ANYCOLUMNHEADER)){var o=e.getFocusedItemInfo(this);var n=o.cellInRow;var r=e.hasRowHeader(this);var f=r?1:0;var d=e.getVisibleColumnCount(this);var v=parseInt(i.cell.attr("colspan")||1);u(t);if(n+v-f<d){var C=o.cell;var p=a;if(r&&n===0){e.focusItem(this,C+1,null)}else if(v>p){e.focusItem(this,C+v,null)}else if(n+v-f+p>d){e.focusItem(this,C+d-n-1+f,null)}else if(!e.Grouping.isInGroupHeaderRow(t.target)){e.focusItem(this,C+p,null)}}else if(i.isOfType(s.DATACELL)&&e.hasRowActions(this)&&n===o.columnCount-2){e.focusItem(this,o.cell+1,null)}}}};c.prototype.onsapenter=function(e){b(this,e)};return c});
//# sourceMappingURL=KeyboardDelegate.js.map